<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AgriOrganizer</title>

<style>
body {
  margin: 0;
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  background-color: #7FAE5D;
  font-family: Arial, Helvetica, sans-serif;
  color: #ffffff;
  text-align: center;
}

.container {
  max-width: 420px;
  padding: 24px;
  position: relative;
}

h1 {
  margin-bottom: 6px;
  font-size: 2.5rem;
}

/* ---------- Language Switch ---------- */
.lang-switch {
  position: absolute;
  top: 34px;
  right: 10px;
  display: flex;
  gap: 6px;
}

.lang-switch img {
  width: 24px;
  height: 16px;
  cursor: pointer;
  opacity: 0.6;
}

.lang-switch img.active {
  opacity: 1;
  outline: 2px solid #fff;
}

/* ---------- Slideshow ---------- */
.slideshow {
  position: relative;
  overflow: hidden;
  border-radius: 12px;
  margin-top: 24px;
  min-height: 300px;
}

.timebar {
  position: absolute;
  top: 0;
  left: 0;
  height: 4px;
  width: 100%;
  background: rgba(255,255,255,0.3);
  z-index: 10;
}

.timebar-fill {
  height: 100%;
  background: #fff;
  transform-origin: left;
  transform: scaleX(0);
}

.slide {
  position: absolute;
  inset: 0;
  opacity: 0;
  transition: opacity 0.6s ease;
}

.slide.active {
  opacity: 1;
  position: relative;
}

.slide img {
  max-width: 100%;
  border-radius: 8px;
}

.slide-text {
  min-height: 80px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.1rem;
}

/* ---------- Click Zones ---------- */
.slide-nav {
  position: absolute;
  top: 0;
  bottom: 0;
  width: 50%;
  z-index: 5;
}

.slide-nav.left { left: 0; }
.slide-nav.right { right: 0; }

/* ---------- Dots ---------- */
.dots {
  display: flex;
  justify-content: center;
  gap: 6px;
  margin: 8px 0;
}

.dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: rgba(255,255,255,0.5);
}

.dot.active {
  background: #fff;
}

/* ---------- Store ---------- */
.store-buttons img {
  width: 200px;
  display: block;
  margin: auto;
}

/* ---------- Buttons ---------- */
a.button.apple img {
    filter: grayscale(100%);
    opacity: 0.6; /* optional etwas transparent */
}

.coming-soon {
  margin: 0;
  font-size: 0.85rem;
}

.footer a {
  color: #fff;
  text-decoration: underline;
}

#debugLog {
  margin-top: 10px;
  font-size: 0.7rem;
  line-height: 1.1rem;
  opacity: 0.6;
  max-height: 80px;
  overflow-y: auto;
  text-align: left;
}

</style>
</head>

<body>

<div class="container">

  <div class="lang-switch">
    <img src="https://flagcdn.com/w20/gb.png" id="lang-en">
    <img src="https://flagcdn.com/w20/de.png" id="lang-de">
  </div>

  <h1>AgriOrganizer</h1>

  <div class="slideshow">
	
    <div class="timebar">
			<div class="timebar-fill" id="timebar"></div>
		</div>

    <div class="slide-nav left" id="prev"></div>
    <div class="slide-nav right" id="next"></div>

    <div class="slide active">
      <img src="startpicture1.png">
      <div class="slide-text" data-i18n="s0"></div>
    </div>

    <div class="slide">
      <img src="slide1.png">
      <div class="slide-text" data-i18n="s1"></div>
    </div>

    <div class="slide">
      <img src="slide2.png">
      <div class="slide-text" data-i18n="s2"></div>
    </div>

    <div class="slide">
      <img src="slide3.png">
      <div class="slide-text" data-i18n="s3"></div>
    </div>
  </div>

  <div class="dots" id="dots"></div>

	<div class="store-buttons">
	  <!-- Google Play Badge -->
	  <a class="button google" href="https://play.google.com/store/apps/details?id=com.ironsofttech.agriorganizer" target="_blank">
		<img src="https://play.google.com/intl/en_us/badges/static/images/badges/de_badge_web_generic.png" alt="Google Play Store">
	  </a>
	  <!-- Apple App Store Badge (ausgegraut) -->
	  <a class="button apple">
		<img src="https://developer.apple.com/assets/elements/badges/download-on-the-app-store.svg" alt="Apple App Store">
	  </a>
    <p class="coming-soon" data-i18n="soon"></p>
  </div>

  <div class="footer">
    <p><a id="privacyLink" data-i18n="privacy"></a></p>
		<!-- DEBUG LOG -->
		<div id="debugLog"></div>
  </div>

</div>

<script>
/* ---------- Language ---------- */
const texts = {
  en: {
    s0: "Organizes cooperation with contractors and neighbors.",
    s1: "Create calendars for machines and resources.",
    s2: "Create offers and publish them online.",
    s3: "Search offers and send booking requests.",
    soon: "*coming soon",
    privacy: "Privacy Policy",
    href: "legals/en/legalInformations_1.0.html"
  },
  de: {
    s0: "Organisiert die Zusammenarbeit mit Lohnunternehmen und Nachbarn.",
    s1: "Erstelle Kalender f체r Maschinen und Ressourcen.",
    s2: "Erstelle Angebote und stelle sie online.",
    s3: "Suche Angebote und sende Buchungsanfragen.",
    soon: "*demn채chst verf체gbar",
    privacy: "Datenschutzerkl채rung",
    href: "legals/de/legalInformations_1.0.html"
  }
};

// logging
const debugLog = document.getElementById("debugLog");
function log(msg) {
  const time = new Date().toLocaleTimeString();
  debugLog.innerHTML = "<div>"+ msg + "</div>" + debugLog.innerHTML;
}

let lang = localStorage.getItem("lang") || "en";
function setLang(l) {
  document.querySelectorAll("[data-i18n]").forEach(el => {
    const key = el.dataset.i18n;
    if (texts[l][key]) el.textContent = texts[l][key];
  });
  document.getElementById("privacyLink").href = texts[l].href;
  document.getElementById("lang-en").classList.toggle("active", l === "en");
  document.getElementById("lang-de").classList.toggle("active", l === "de");
  localStorage.setItem("lang", l);
}

lang === "de" ? setLang("de") : setLang("en");
document.getElementById("lang-en").onclick = () => setLang("en");
document.getElementById("lang-de").onclick = () => setLang("de");

// longclick disable
document.querySelectorAll(".slide img").forEach(img => {
    img.addEventListener("contextmenu", e => e.preventDefault());
});

/* ---------- Slideshow ---------- */
const slides = document.querySelectorAll(".slide");
const dotsContainer = document.getElementById("dots");
const timebar = document.getElementById("timebar");

const DURATION = 6000;
const LONG_PRESS = 400;

let index = 0;
let timer = null;
let startTime = 0;
let remaining = DURATION;
let isPaused = false;
let longPressActive = false;
let pressTimer;

/* ---------- Dots ---------- */
slides.forEach((_, i) => {
  const d = document.createElement("div");
  d.className = "dot" + (i === 0 ? " active" : "");
  dotsContainer.appendChild(d);
});
const dots = dotsContainer.children;

/* ---------- Core ---------- */
function activateSlide(i, reset = true) {
  slides[index].classList.remove("active");
  dots[index].classList.remove("active");

  index = (i + slides.length) % slides.length;

  slides[index].classList.add("active");
  dots[index].classList.add("active");

  if (reset) {
    remaining = DURATION;
    startTimer();
  }
}

/* ---------- Timer ---------- */
function startTimer() {
  clearTimeout(timer);
  isPaused = false;
  startTime = Date.now();

  timebar.style.transition = "none";
  timebar.style.transform = `scaleX(${1 - remaining / DURATION})`;

  requestAnimationFrame(() => {
    timebar.style.transition = `transform ${remaining}ms linear`;
    timebar.style.transform = "scaleX(1)";
  });

  timer = setTimeout(() => activateSlide(index + 1, true), remaining);
}

function pauseTimer() {
  if (isPaused) return;
  isPaused = true;

  clearTimeout(timer);
  const elapsed = Date.now() - startTime;
  remaining -= elapsed;

  timebar.style.transition = "none";
  timebar.style.transform = `scaleX(${1 - remaining / DURATION})`;
}

/* ---------- Input ---------- */
function onPressStart() {
  longPressActive = false;
  pressTimer = setTimeout(() => {
    longPressActive = true;
    pauseTimer();
  }, LONG_PRESS);
}

function onPressEnd(dir) {
  clearTimeout(pressTimer);

  if (longPressActive) {
    startTimer(); // resume
  } else {
    activateSlide(index + dir, true);
  }
}

/* ---------- Global pointerup / touchend ---------- */
document.addEventListener("pointerup", handleRelease);
document.addEventListener("touchend", handleRelease);

function handleRelease(e) {
	log("handleRelease:" + longPressActive + " " + isPaused);
  if (longPressActive && isPaused) {
    resumeTimer();
    longPressActive = false;
  }
}

/* ---------- Events ---------- */

["pointerdown"].forEach(e => {
  prev.addEventListener(e, onPressStart);
  next.addEventListener(e, onPressStart);
});

["pointerup"].forEach(e => {
  prev.addEventListener(e, () => onPressEnd(-1));
  next.addEventListener(e, () => onPressEnd(1));
});

/* Global catch */
document.addEventListener("pointerup", handleRelease);
document.addEventListener("touchend", handleRelease);

/* start */
startTimer();
</script>

</body>
</html>
